<script>
  $(document).ready( function() {
    function taskHtml(task) {
      var checkedStatus = task.done ? 'checked' : '';
      var liElement = '<li><div class="view">' +
                      '<input class="toggle" type="checkbox"' + "data-id='" +task.id + "'" +checkedStatus+ '>' +
                      '<label>' + task.title+ '</label>' +
                      '</div></li>';
      return liElement;
    }

    function taskToggle(event) {
      var itemId = $(event.target).data('id');
      var doneValue = Boolean($(event.target).is(':checked'));
      $.post("/tasks/" + itemId, {
        _method: "PUT",
        task: { done: doneValue }
      });
    }

    $.get('/tasks').success( function(data)  {
      var htmlString = '';
      $.each(data, function(index, task) {
        console.log("each loop. index: " +index +'\ttask id: ' +task.id+ '\ttitle: ' +task.title+ '\tdone: ' +task.done);     
        htmlString += taskHtml(task);
      });
      var ulTodos = $('.todo-list');
      ulTodos.html(htmlString);

      $('.toggle').change(taskToggle);     
    });   // end $.get

  });   // end document ready
</script>

<section class='todoapp'>
  <header class='header'>
    <h1>TO-DOs</h1>
  </header>
  <section class='main'>
    <ul class='todo-list'>

    </ul>
  </section>
</section>

